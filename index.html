<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>hello-vue</title>
    <link href="./styles.css" rel="stylesheet">
    <script src="./vendor/vue.js"></script>
    <script src="./utils/vue-inject.js"></script>
</head>

<body>
    <div class="container">
        <div id="basic">
            <div class="comment">// 基本模版 </div>
            <h3>Hello {{name}}</h3>
        </div>
        <script>
            new Vue({
                el: "#basic",
                data: {
                    name: "xyy"
                }
            })
        </script>
    </div>
    <div class="container">
        <div id="model-bind">
            <div class="comment">// 双向绑定 </div>
            <div class="horizontal">
                <input v-model="name" placeholder="你的名字">
                <h3>Your name is <span class="underline">{{name}}</span></h3>
            </div>
        </div>
        <script>
            new Vue({
                el: "#model-bind",
                data: {
                    name: "xyy"
                }
            })
        </script>
    </div>

    <div class="container">
        <div id="life-cycle">
            <div class="comment">// 生命周期：组件数据绑定 => 组件挂载 => 解绑组件</div>
            <h3>{{output}}</h3>
        </div>
        <script>
            new Vue({
                el: "#life-cycle",
                data: {
                    output: "init"
                },
                created() {
                    this.output += ` / created(el=${this.$el})`
                },
                mounted() {
                    this.output += ` / mounted(el=${this.$el})`
                },
                beforeDistroy() {
                    this.output += " / beforeDistroy"
                }
            })
        </script>
    </div>

    <div class="container">
        <div id="template">
            <div class="comment">// 高级模版</div>
            <div>
                <p v-pre>{{ignored}}</p>
                <p v-html="htmlValue"></p>
                <p>表达式求值 {{value}} / 2 = {{value / 2}}</p>
                <p>三元表达式 {{boolValue ? "isTrue" : "isFalse"}}</p>
                <p>iife {{(num => num + 1)(value)}}</p>
                <p>过滤器 {{stringValue | padLeft(2) | trailingComma}}</p>
            </div>
        </div>
        <script>
            new Vue({
                el: "#template",
                data: {
                    value: 10,
                    boolValue: false,
                    stringValue: "i am xyy",
                    htmlValue: "<code>htmlValue</code>"
                },
                filters: {
                    padLeft(value, count, filler = "*") {
                        return new Array(count).fill(filler).join("") + value
                    },
                    trailingComma(value) {
                        return value + ";"
                    }
                }
            })
        </script>
    </div>

    <div class="container">
        <div id="directive">
            <div class="comment">// 指令</div>
            <div>
                <p v-pre>{{ignored}}</p>
                <label>
                    boolValue
                    <input type="checkbox" v-model="boolValue">
                </label>
                <p v-if="boolValue">visible if boolValue is true</p>
                <p v-bind:class="boolValue && 'warning'">警告信息</p>
                <p :class="{ warning: boolValue }">语法糖 + class对象</p>
                <div class="horizontal">
                    <button v-on:click="add">add {{value}}</button>
                    <button @click="() => {value--}">minus {{value}}</button>
                </div>
                <ul>
                    <li v-for="(item, index) of arrayValue">{{index + 1}} - {{item}}</li>
                </ul>
            </div>
        </div>
        <script>
            new Vue({
                el: "#directive",
                data: {
                    value: 1,
                    boolValue: true,
                    arrayValue: ["React", "Vue", "Angular"]
                },
                methods: {
                    add() {
                        this.value++
                    }
                }
            })
        </script>
    </div>

    <div class="container">
        <div id="computed">
            <div class="comment">// 计算属性</div>
            <div>
                <label>
                    输入数字
                    <input v-model="value" type="number">
                </label>
                <label>
                    输入结果
                    <input v-model="computedValue" type="number">
                </label>
                <h3 v-html="computedValueText"></h3>
            </div>
        </div>
        <script>
            new Vue({
                el: "#computed",
                data: {
                    value: 1,
                },
                computed: {
                    computedValue: {
                        get() {
                            return Math.round(this.value * this.value)
                        },
                        set(result) {
                            this.value = Math.sqrt(result)
                        }
                    },
                    computedValueText() {
                        // 依赖计算属性的计算属性
                        return `${this.value}<sup>2</sup> = ${this.computedValue}`
                    }
                }
            })
        </script>
    </div>

    <div class="container">
        <div v-cloak id="advanced-directive">
            <div class="comment">// 高级指令</div>
            <p v-once>只渲染一次value（初始值） = {{value}}</p>
            <button @click="() => value++">{{value}}</button>
            <div v-if="value % 2 == 0">
                <span>打开devtool看看：这个重复元素没有渲染</span>
                <b>v-if 偶数</b>
            </div>
            <div v-else>
                <span>打开devtool看看：这个重复元素没有渲染</span>
                <b>v-else 奇数</b>
            </div>
            <div v-show="value % 2 == 0">v-show=false只会把元素设置成display: none</div>
            <ul>
                <li v-for="(count, index) of arrayValue" @click="add(index)">点我 {{count}}</li>
            </ul>
        </div>

        <style>
            [v-cloak] {
                /* 放在根结点上可以防止闪烁，当Vue下载完成后会自动删除这个属性 */
                display: none;
            }
        </style>

        <script>
            new Vue({
                el: "#advanced-directive",
                data: {
                    value: 1,
                    arrayValue: [0, 0, 0]
                },
                methods: {
                    add(id) {
                        // 直接修改 array[index] 不会被注意到
                        // this.$set(this.arrayValue, index, this.arrayValue[index] + 1)
                        // 或者使用 immutable，由于vdom的存在，不会有性能问题
                        this.arrayValue = this.arrayValue.map((count, index) => {
                            return (index === id) ? count + 1 : count
                        })
                    }
                }
            })
        </script>
    </div>

    <div class="container">
        <div id="event">
            <div class="comment">// 事件</div>
            <h1>{{ value }}</h1>
            <button @click="onAdd()">add 1</button>
            <button @click="onAdd(10)">add 10</button>
            <button @click="onAdd">add event</button>
            <div>
                <button style="margin-top: 10px;" @click.left="onAdd()" @click.right.prevent="onAdd(10)">修饰器按钮</button>
            </div>
        </div>
        <script>
            new Vue({
                el: "#event",
                data: {
                    value: 1,
                },
                methods: {
                    onAdd(count = 1) {
                        // @click直接写函数，会传入event
                        this.value += count
                    }
                }
            })
        </script>
    </div>

    <div class="container" disable-active>
        <div class="comment">// 项目</div>
        <div id="projects">
            <p>为了巩固这些基础知识，做了一些实战项目。</p>
            <p>首先是<a href="./projects/market">购物车项目</a>, 使用了经典的html/js/css结构，和基本的Vue功能</p>
        </div>
    </div>


    <div id="preview-plugin"></div>
    <link href="./vendor/github.css" rel="stylesheet">
    <script src="./vendor/highlight.pack.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.10.2/beautify-html.min.js"></script>
    <script src="./utils/helper.js"></script>
</body>

</html>